(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{418:function(e,t,a){e.exports=a.p+"assets/img/kano-ogc-layers.00dcca9c.png"},419:function(e,t,a){e.exports=a.p+"assets/img/kano-file-layers.a0f67c66.png"},420:function(e,t,a){e.exports=a.p+"assets/img/kano-covid-19-layers.52e949e8.png"},421:function(e,t,a){e.exports=a.p+"assets/img/kano-covid-19-layers-3D.03da5215.png"},422:function(e,t,a){e.exports=a.p+"assets/img/kano-sensors-layers.b8ce7d75.png"},447:function(e,t,a){"use strict";a.r(t);var n=a(5),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"customizing-kano"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#customizing-kano"}},[e._v("#")]),e._v(" Customizing Kano")]),e._v(" "),n("p",[e._v("This section details different approaches to integrate your own data to your Kano instance. Although you can directly use the Kano UI to add your own data layers this section provide details to do this by configuration or programmatically. When added through the UI, the different layers will be visible in the "),n("em",[e._v("My data")]),e._v(" tab of the "),n("RouterLink",{attrs:{to:"/guides/getting-started.html#catalog"}},[e._v("catalog panel")]),e._v(", while the default built-in layers will appear in the "),n("em",[e._v("Catalog")]),e._v(" tab of the "),n("RouterLink",{attrs:{to:"/guides/getting-started.html#catalog"}},[e._v("catalog panel")]),e._v(". You can also manage the "),n("strong",[e._v("categories")]),e._v(" (i.e. catalog sections) hosting the layers from the UI or the configuration.")],1),e._v(" "),n("p",[e._v("Although names and descriptions can be hard-coded in the target user language, Kano supports internationalization through a nested structure organized by locale like this:")]),e._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n\t"),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Categories.POPULATION_LAYERS'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("i18n")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("fr")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("Categories")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[e._v("POPULATION_LAYERS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Population'")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("en")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("Categories")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[e._v("POPULATION_LAYERS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Population'")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("...")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),n("blockquote",[n("p",[e._v("Note that the "),n("code",[e._v("name")]),e._v(" property is used a unique identifier for categories and layers")])]),e._v(" "),n("h2",{attrs:{id:"customizing-the-catalog"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#customizing-the-catalog"}},[e._v("#")]),e._v(" Customizing the catalog")]),e._v(" "),n("p",[e._v("You can add your own categories in the catalog by defining it in additional files to be put in the "),n("code",[e._v("kano/api/config/categories")]),e._v(" directory. Kano will glob all files within this directory and add categories accordingly, only matching by name those in the "),n("code",[e._v("CATEGORIES_FILTER")]),e._v(" (comma-separated list of category names) environment variable, if any. Categories are simple objects with a name, a description and an icon from a standard icon set among [Material Icons]https://fonts.google.com/icons?icon.set=Material+Icons), "),n("a",{attrs:{href:"https://fontawesome.com/icons",target:"_blank",rel:"noopener noreferrer"}},[e._v("Font Awesome"),n("OutboundLink")],1),e._v(", or "),n("a",{attrs:{href:"https://icons8.com/line-awesome",target:"_blank",rel:"noopener noreferrer"}},[e._v("Line Awesome"),n("OutboundLink")],1),e._v(".")]),e._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[e._v("my-categories.cjs - Used to define additional categories.")]),e._v(" "),n("div",{staticClass:"language-cjs extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("module.exports = [{\n  name: 'Categories.OSM_LAYERS',\n  i18n: {\n    fr: {\n      Categories: {\n        OSM_LAYERS: 'OpenStreetMap'\n      }\n    },\n    en: {\n      Categories: {\n        OSM_LAYERS: 'OpenStreetMap'\n      }\n    }\n  },\n  icon: 'las la-map',\n  options: { exclusive: true, filter: { type: 'BaseLayer', tags: { $in: ['osm'] } } }\n}, {\n  name: 'Categories.POPULATION_LAYERS',\n  i18n: {\n    fr: {\n      Categories: {\n        POPULATION_LAYERS: 'Population'\n      }\n    },\n    en: {\n      Categories: {\n        POPULATION_LAYERS: 'Population'\n      }\n    }\n  },\n  icon: 'las la-users',\n  options: { exclusive: false, filter: { type: 'OverlayLayer', tags: { $in: ['population'] } } }\n}]")])])])]),e._v(" "),n("p",[e._v("Layers that will be added in a given category depends on the "),n("code",[e._v("filter")]),e._v(" property content, which defines a "),n("a",{attrs:{href:"https://github.com/crcn/sift.js",target:"_blank",rel:"noopener noreferrer"}},[e._v("sift filter"),n("OutboundLink")],1),e._v(" applied to the layers list. Although any filter can be used, a "),n("code",[e._v("tags")]),e._v(" property containing an array of relevent tags is often used by convention.")]),e._v(" "),n("h2",{attrs:{id:"customizing-the-catalog-data"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#customizing-the-catalog-data"}},[e._v("#")]),e._v(" Customizing the catalog data")]),e._v(" "),n("p",[e._v("You can add your own layers in the catalog by defining it in additional files to be put in the "),n("code",[e._v("kano/api/config/layers")]),e._v(" directory. Kano will glob all files within this directory and add layers accordingly, only matching by name those in the "),n("code",[e._v("LAYERS_FILTER")]),e._v(" (comma-separated list of layer names) environment variable by default (set it to "),n("code",[e._v("*")]),e._v(" to remove filtering). Layers are simple objects with a name, a description, a type, an attribution, and additional configuration options related to the underlying mapping engine: "),n("a",{attrs:{href:"https://leafletjs.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Leaflet"),n("OutboundLink")],1),e._v(" for 2D rendering and "),n("a",{attrs:{href:"https://cesium.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Cesium"),n("OutboundLink")],1),e._v(" for 3D rendering. More details about these options can be found in the documentation of the "),n("a",{attrs:{href:"https://kalisio.github.io/kdk/api/map/",target:"_blank",rel:"noopener noreferrer"}},[e._v("KDK"),n("OutboundLink")],1),e._v(" powering Kano.")]),e._v(" "),n("blockquote",[n("p",[e._v("Please refer to the built-in "),n("code",[e._v("kano/api/config/layers")]),e._v(" directory for various examples of what is possible to do with Kano.")])]),e._v(" "),n("p",[e._v("We will start with a really simple example by adding two different map backgrounds based on "),n("a",{attrs:{href:"https://www.openstreetmap.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenStreetMap data"),n("OutboundLink")],1),e._v(" to your Kano instance. First ensure you copied the categories and layers files in their respective directories in "),n("code",[e._v("kano/api/config")]),e._v(". Then, set "),n("code",[e._v('CATEGORIES_FILTER="OSM_LAYERS POPULATION_LAYERS"')]),e._v(" and "),n("code",[e._v('LAYERS_FILTER="OSM OSM_CYCLE"')]),e._v(" in your environment. Last, launch Kano to make the layers appear in your custom catalog.")]),e._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[e._v("osm-layers.cjs - Used to define base layers with OpenStreetMap data.")]),e._v(" "),n("div",{staticClass:"language-cjs extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("module.exports = [{\n  name: 'Layers.OSM',\n  description: 'Layers.OSM_DESCRIPTION',\n  i18n: {\n    fr: {\n      Layers: {\n        OSM: 'OpenStreeMap',\n        OSM_DESCRIPTION: 'Données OpenStreetMap'\n      }\n    },\n    en: {\n      Layers: {\n        OSM: 'OpenStreeMap',\n        OSM_DESCRIPTION: 'OpenStreeMap data'\n      }\n    }\n  },\n  tags: ['osm'],\n  attribution: 'OpenStreetMap © <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors',\n  type: 'BaseLayer',\n  leaflet: {\n    type: 'tileLayer',\n    isVisible: true,\n    source: 'http://{s}.tile.osm.org/{z}/{x}/{y}.png',\n    maxZoom: 21,\n    maxNativeZoom: 18\n  },\n  cesium: {\n    type: 'OpenStreetMap',\n    isVisible: true,\n    url: `http://a.tile.osm.org`\n  }\n}, {\n  name: 'Layers.OSM_CYCLE',\n  description: 'Layers.OSM_CYCLE_DESCRIPTION',\n  i18n: {\n    fr: {\n      Layers: {\n        OSM_CYCLE: 'OpenCycleMap',\n        OSM_CYCLE_DESCRIPTION: 'Données OpenCycleMap'\n      }\n    },\n    en: {\n      Layers: {\n        OSM_CYCLE: 'OpenCycleMap',\n        OSM_CYCLE_DESCRIPTION: 'OpenCycleMap data'\n      }\n    }\n  },\n  attribution: 'OpenStreetMap © <a href=\"https://www.opencyclemap.org/\">OpenCycleMap</a> contributors',\n  type: 'BaseLayer',\n  tags: ['osm'],\n  leaflet: {\n    type: 'tileLayer',\n    isVisible: false,\n    source: 'http://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png',\n    maxZoom: 21,\n    maxNativeZoom: 18\n  },\n  cesium: {\n    type: 'OpenStreetMap',\n    url: `http://a.tile.thunderforest.com/cycle`,\n    isVisible: false\n  }\n}]\n")])])])]),e._v(" "),n("p",[e._v("Except for raster data, vector data are always converted to GeoJson upfront or as a rendering preprocessing phase in Kano.")]),e._v(" "),n("h3",{attrs:{id:"using-ogc-standards"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#using-ogc-standards"}},[e._v("#")]),e._v(" Using OGC standards")]),e._v(" "),n("p",[e._v("OGC Web Services (OWS) are the "),n("a",{attrs:{href:"https://www.ogc.org/standards/",target:"_blank",rel:"noopener noreferrer"}},[e._v("OGC standards"),n("OutboundLink")],1),e._v(" that use the internet to view, edit, manage and share geospatial data. You can notably use the following standards in Kano:")]),e._v(" "),n("ul",[n("li",[e._v("Web Map Services (WMS)")]),e._v(" "),n("li",[e._v("Web Map Tile Service (WMTS)")]),e._v(" "),n("li",[e._v("Tile Map Service (TMS)")]),e._v(" "),n("li",[e._v("Web Feature Service (WFS)")]),e._v(" "),n("li",[e._v("Web Coverage Service (WCS)")])]),e._v(" "),n("p",[e._v("In this section we will use OGC web services of the "),n("a",{attrs:{href:"https://geoservices.ign.fr/services-web-experts",target:"_blank",rel:"noopener noreferrer"}},[e._v("French geographical institute"),n("OutboundLink")],1),e._v(" (IGN). First copy the new layers file in the "),n("code",[e._v("kano/api/config/layers")]),e._v(" directory. Then, add "),n("code",[e._v('"POPULATION_DENSITY_WMTS POPULATION_DENSITY_WMS AIRPORTS_WFS"')]),e._v(" to your "),n("code",[e._v("LAYERS_FILTER")]),e._v(" environment variable and launch Kano again to make the new layers appear in your custom catalog.")]),e._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[e._v("ogc-layers.cjs - Used to define additional layers using different protocols like WMTS, WMS and WFS.")]),e._v(" "),n("div",{staticClass:"language-cjs extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("module.exports = [{\n  name: 'Layers.POPULATION_DENSITY_WMTS',\n  description: 'Layers.POPULATION_DENSITY_WMTS_DESCRIPTION',\n  i18n: {\n    fr: {\n      Layers: {\n        POPULATION_DENSITY_WMTS: 'Densité (WMTS)',\n        POPULATION_DENSITY_WMTS_DESCRIPTION: 'Densité de population (IGN)'\n      }\n    },\n    en: {\n      Layers: {\n        POPULATION_DENSITY_WMTS: 'Density (WMTS)',\n        POPULATION_DENSITY_WMTS_DESCRIPTION: 'Population density (IGN)'\n      }\n    }\n  },\n  type: 'OverlayLayer',\n  attribution: '© <a href=\"https://ign.fr\">IGN</a>',\n  tags: ['population'],\n  cesium: {\n    type: 'WebMapTileService',\n    url: 'https://wxs.ign.fr/economie/geoportail/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=INSEE.FILOSOFI.POPULATION&STYLE=INSEE&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={TileMatrix}&TILEROW={TileRow}&TILECOL={TileCol}',\n    format: 'image/png',\n    layer: 'INSEE.FILOSOFI.POPULATION',\n    style: 'INSEE',\n    tileMatrixSetID: 'PM',\n    isVisible: false\n  },\n  leaflet: {\n    type: 'tileLayer',\n    source: 'https://wxs.ign.fr/economie/geoportail/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=INSEE.FILOSOFI.POPULATION&STYLE=INSEE&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}',\n    bounds: [ [40, -5], [50, 10] ],\n    opacity: 0.5,\n    isVisible: false\n  },\n  legendUrl: 'https://wxs.ign.fr/static/legends/INSEE.FILOSOFI.POPULATION-tot-legend-2017.png'\n}, {\n  name: 'Layers.POPULATION_DENSITY_WMS',\n  description: 'Layers.POPULATION_DENSITY_WMS_DESCRIPTION',\n  i18n: {\n    fr: {\n      Layers: {\n        POPULATION_DENSITY_WMS: 'Densité (WMS)',\n        POPULATION_DENSITY_WMS_DESCRIPTION: 'Densité de population (IGN)'\n      }\n    },\n    en: {\n      Layers: {\n        POPULATION_DENSITY_WMS: 'Density (WMS)',\n        POPULATION_DENSITY_WMS_DESCRIPTION: 'Population density (IGN)'\n      }\n    }\n  },\n  type: 'OverlayLayer',\n  attribution: '© <a href=\"https://ign.fr\">IGN</a>',\n  tags: ['population'],\n  cesium: {\n    type: 'WebMapService',\n    url: 'https://wxs.ign.fr/economie/geoportail/r/wms',\n    layers: 'INSEE.FILOSOFI.POPULATION',\n    parameters: {\n      version: '1.3.0',\n      format: 'image/png',\n      transparent: true,\n      styles: 'INSEE'\n    },\n    isVisible: false\n  },\n  leaflet: {\n    type: 'tileLayer.wms',\n    source: 'https://wxs.ign.fr/economie/geoportail/r/wms',\n    layers: 'INSEE.FILOSOFI.POPULATION',\n    version: '1.3.0',\n    format: 'image/png',\n    transparent: true,\n    bgcolor: 'FFFFFFFF',\n    styles: 'INSEE',\n    opacity: 0.5,\n    isVisible: false\n  },\n  legendUrl: 'https://wxs.ign.fr/static/legends/INSEE.FILOSOFI.POPULATION-tot-legend-2017.png'\n}, {\n  name: 'Layers.AIRPORTS_WFS',\n  description: 'Layers.AIRPORTS_WFS_DESCRIPTION',\n  i18n: {\n    fr: {\n      Layers: {\n        AIRPORTS_WFS: 'Aérodromes (WFS)',\n        AIRPORTS_WFS_DESCRIPTION: 'Aérodromes (IGN)'\n      }\n    },\n    en: {\n      Layers: {\n        AIRPORTS_WFS: 'Airports (WFS)',\n        AIRPORTS_WFS_DESCRIPTION: 'Airports (IGN)'\n      }\n    }\n  },\n  type: 'OverlayLayer',\n  icon: 'las la-plane',\n  tags: ['administrative'],\n  bbox: [\n    -63.1537116941531,\n    -21.3898266619462,\n    55.8367758165235,\n    51.3150480097903\n  ],\n  featureId: 'toponyme',\n  wfs: {\n    url: 'https://wxs.ign.fr/cartovecto/geoportail/wfs',\n    version: '2.0.0',\n    searchParams: {},\n    outputFormat: 'json',\n    layer: 'BDCARTO_V5:aerodrome'\n  },\n  leaflet: {\n    type: 'geoJson',\n    realtime: true,\n    tiled: true,\n    minZoom: 10\n  },\n  cesium: {\n    type: 'geoJson',\n    realtime: true\n  }\n}]\n")])])])]),e._v(" "),n("p",[e._v("You now should be able to see this after making some of the layers active:")]),e._v(" "),n("p",[n("img",{attrs:{src:a(418),alt:"ogc layers"}})]),e._v(" "),n("p",[e._v("Due to the possible large amount of vector data coming from the WFS the layer is configured with "),n("code",[e._v("minZoom")]),e._v(" and "),n("code",[e._v("tiled")]),e._v(" property so that data is only retrieved when zoom level exceed 10 for visible tiles only.")]),e._v(" "),n("h3",{attrs:{id:"using-data-files"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#using-data-files"}},[e._v("#")]),e._v(" Using data files")]),e._v(" "),n("p",[e._v("Except by using the UI, there are two ways of adding data coming from a file based on configuration:")]),e._v(" "),n("ol",[n("li",[e._v("serve and directly access the file over HTTP,")]),e._v(" "),n("li",[e._v("ingest the file data into the database and access it using a built-in web service.")])]),e._v(" "),n("p",[e._v("The second option is mandatory for large datasets or if you'd like to perform some filtering based on data feature properties. Accessing data stored in the database rely on the concept of "),n("a",{attrs:{href:"https://feathersjs.com/api/services.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("FeathersJS service"),n("OutboundLink")],1),e._v(". As a consequence, the layer is usually associated with one (or more) source service where the data come from. Moreover, you should define a unique "),n("code",[e._v("featureId")]),e._v(" on your features so that Kano can correctly separate and update data.")]),e._v(" "),n("blockquote",[n("p",[e._v("The data can be retrieved from a raw file with the "),n("code",[e._v("fileName")]),e._v(" layer property or a remote file with the "),n("code",[e._v("url")]),e._v(" layer property.")])]),e._v(" "),n("p",[e._v("You should have a look to our detailed documentation for all possible styling options in "),n("a",{attrs:{href:"https://kalisio.github.io/kdk/api/map/map-mixins.html#map-style",target:"_blank",rel:"noopener noreferrer"}},[e._v("2D"),n("OutboundLink")],1),e._v(" or "),n("a",{attrs:{href:"https://kalisio.github.io/kdk/api/map/map-mixins.html#globe-style",target:"_blank",rel:"noopener noreferrer"}},[e._v("3D"),n("OutboundLink")],1),e._v(".")]),e._v(" "),n("p",[e._v("First copy the new layers file in the "),n("code",[e._v("kano/api/config/layers")]),e._v(" directory. Then, add "),n("code",[e._v('"REGIONS DEPARTMENTS"')]),e._v(" to your "),n("code",[e._v("LAYERS_FILTER")]),e._v(" environment variable and launch Kano again to make some new layers appear in your custom catalog.")]),e._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[e._v("file-layers.cjs - Used to define additional layers using file data.")]),e._v(" "),n("div",{staticClass:"language-cjs extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("// Base URL to public files hosted in the docs\nconst baseUrl = (process.env.NODE_ENV === 'development' ? 'http://localhost:8082' : 'https://kalisio.github.io/kano')\n\nmodule.exports = [{\n  name: 'Layers.REGIONS',\n  description: 'Layers.REGIONS_DESCRIPTION',\n  i18n: {\n    fr: {\n      Layers: {\n        REGIONS: 'Régions',\n        REGIONS_DESCRIPTION: 'Régions Françaises'\n      }\n    },\n    en: {\n      Layers: {\n        REGIONS: 'Regions',\n        REGIONS_DESCRIPTION: 'French regions'\n      }\n    }\n  },\n  tags: ['administrative'],\n  type: 'OverlayLayer',\n  featureId: 'code',\n  leaflet: {\n    type: 'geoJson',\n    source: `${baseUrl}/regions.geojson`,\n    'stroke-color': 'blue',\n    'fill-opacity': 0,\n    popup: { pick: [] },\n    tooltip: {\n      template: '<b><%= properties.nom %></b>'\n    }\n  },\n  cesium: {\n    type: 'geoJson',\n    source: `${baseUrl}/regions.geojson`,\n    'stroke-color': 'blue',\n    'fill-opacity': 0,\n    popup: { pick: [] },\n    tooltip: {\n      template: '<%= properties.nom %>'\n    }\n  }\n}, {\n  name: 'Layers.DEPARTMENTS',\n  description: 'Layers.DEPARTMENTS_DESCRIPTION',\n  i18n: {\n    fr: {\n      Layers: {\n        DEPARTMENTS: 'Départements',\n        DEPARTMENTS_DESCRIPTION: 'Départements Français'\n      }\n    },\n    en: {\n      Layers: {\n        DEPARTMENTS: 'Departments',\n        DEPARTMENTS_DESCRIPTION: 'French departments'\n      }\n    }\n  },\n  tags: ['administrative'],\n  type: 'OverlayLayer',\n  featureId: 'code',\n  service: 'airports',\n  probe: 'Airports',\n  url: `${baseUrl}/departments.geojson`,\n  // Could also be a file path to a GeoJson or a gzipped GeoJson\n  //fileName: path.join(__dirname, '../../../docs/.vuepress/public/departements.geojson'),\n  leaflet: {\n    type: 'geoJson',\n    source: '/api/departments',\n    'stroke-color': 'red',\n    'fill-opacity': 0,\n    popup: { pick: [] },\n    tooltip: {\n      template: '<b><%= properties.nom %></b>'\n    }\n  },\n  cesium: {\n    type: 'geoJson',\n    source: '/api/departments',\n    'stroke-color': 'red',\n    'fill-opacity': 0,\n    popup: { pick: [] },\n    tooltip: {\n      template: '<%= properties.nom %>'\n    }\n  }\n}]\n")])])])]),e._v(" "),n("p",[e._v("You now should be able to see a map highlighting some administrative boundaries in France:")]),e._v(" "),n("p",[n("img",{attrs:{src:a(419),alt:"file layers"}})]),e._v(" "),n("p",[e._v("If you have to ingest large datasets you should consider processing data using our "),n("a",{attrs:{href:"https://kalisio.github.io/krawler/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ETL Krawler"),n("OutboundLink")],1),e._v(" or ad-hoc processors. For instance, "),n("a",{attrs:{href:"https://github.com/kalisio/k-population",target:"_blank",rel:"noopener noreferrer"}},[e._v("k-population"),n("OutboundLink")],1),e._v(" ingest population data from a big GeoPackage into our database. You will find the associated layer definition in the built-in layers.")]),e._v(" "),n("h4",{attrs:{id:"time-varying-data"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#time-varying-data"}},[e._v("#")]),e._v(" Time-varying data")]),e._v(" "),n("p",[e._v("One of the best feature of Kano is interactive visualisation, meaning that data can be updated in real-time according to user actions or data updates. A typical use case is the visualisation of time-varying spatial datasets. In this section we will use some data providing the number of hospitalizations by department in France during the COVID-19 (from 20-03-2020 to 20-04-2020) to perform such a visualisation.")]),e._v(" "),n("p",[e._v("First copy the new layers file in the "),n("code",[e._v("kano/api/config/layers")]),e._v(" directory. Then, add "),n("code",[e._v('"COVID_19"')]),e._v(" to your "),n("code",[e._v("LAYERS_FILTER")]),e._v(" environment variable and launch Kano again to make the new layers appear in your custom catalog.")]),e._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[e._v("covid-19-layers.cjs - Used to define additional time-varying layers based on file data.")]),e._v(" "),n("div",{staticClass:"language-cjs extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("// Base URL to public files hosted in the docs\nconst baseUrl = (process.env.NODE_ENV === 'development' ? 'http://localhost:8082' : 'https://kalisio.github.io/kano')\n\nmodule.exports = [{\n  name: 'Layers.COVID_19',\n  description: 'Layers.COVID_19_DESCRIPTION',\n  i18n: {\n    fr: {\n      Layers: {\n        COVID_19: 'COVID-19',\n        COVID_19_DESCRIPTION: 'Hospitalisations par département'\n      }\n    },\n    en: {\n      Layers: {\n        COVID_19: 'COVID-19',\n        COVID_19_DESCRIPTION: 'Hospitalizations by department'\n      }\n    }\n  },\n  tags: ['health'],\n  icon: 'fas fa-atlas',\n  attribution: 'Santé Publique Fance / IGN / INSEE',\n  type: 'OverlayLayer',\n  featureId: 'code',\n  every: 'P1D',\n  leaflet: {\n    type: 'geoJson',\n    realtime: true,\n    sourceTemplate: `${baseUrl}/covid-19/hospitalisations-departements-<%= time.format('YYYY-MM-DD') %>.json`,\n    stroke: '#fee8c8',\n    'stroke-width': 2,\n    'stroke-opacity': 0.5,\n    'fill-opacity': 0.5,\n    'fill-color': '<%= chroma.scale(\\'OrRd\\').domain([0,50])(properties.taux).hex() %>',\n    template: ['fill-color'],\n    tooltip: {\n      template: '<b><%= properties.nom %>: <%= properties.hospitalisations %> hospitalisations</b>',\n      options: {\n        opacity: 0.8,\n        direction: 'top'\n      }\n    }\n  },\n  cesium: {\n    type: 'geoJson',\n    realtime: true,\n    sourceTemplate: `${baseUrl}/covid-19/hospitalisations-departements-<%= time.format('YYYY-MM-DD') %>.json`,\n    entityStyle: {\n      polygon: {\n        outline: false,\n        extrudedHeight: '<%= 1000 * properties.taux %>',\n        material: {\n          type: 'Cesium.ColorMaterialProperty',\n          options: {\n            type: 'Cesium.Color.fromCssColorString',\n            options: '<%= chroma.scale(\\'OrRd\\').domain([0,50])(properties.taux).css() %>'\n          }\n        }\n      },\n      template: ['polygon.extrudedHeight', 'polygon.material.options.options']\n    },\n    tooltip: {\n      template: '<%= properties.nom %>: <%= properties.hospitalisations %> hospitalisations'\n    }\n  }\n}]\n")])])])]),e._v(" "),n("p",[e._v("Using the bottom timeline, navigate to some dates within the data time range, you now should be able to see a choropleth map highlighting the number of hospitalizations for each date:")]),e._v(" "),n("p",[n("img",{attrs:{src:a(420),alt:"covid-19 layers"}})]),e._v(" "),n("p",[e._v("You can even do the same using the 3D activity:")]),e._v(" "),n("p",[n("img",{attrs:{src:a(421),alt:"covid-19 layers in 3D"}})]),e._v(" "),n("h3",{attrs:{id:"using-the-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#using-the-api"}},[e._v("#")]),e._v(" Using the API")]),e._v(" "),n("p",[e._v("The Kano API is particularly useful to update data continuously, a typical use case is data coming from network sensors performing measurements on the ground.")]),e._v(" "),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),n("p",[e._v("You should use the "),n("code",[e._v("local.cjs")]),e._v(" configuration file as stated in the "),n("RouterLink",{attrs:{to:"/guides/installing-kano.html"}},[e._v("installation")]),e._v(" section to setup a user account with appropriate rights (i.e. write acces to the API).")],1)]),e._v(" "),n("p",[e._v("The different service endpoints of Kano can be accessed using REST as the most universal interface or using WebSockets if required (typically for complex queries or performance issue). The access to the endpoints are protected using a "),n("a",{attrs:{href:"https://jwt.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("JWT"),n("OutboundLink")],1),e._v(" (i.e. token), it must be defined using the "),n("code",[e._v("Authorization")]),e._v(" header ("),n("code",[e._v("Bearer token")]),e._v(") in the request header for REST.")]),e._v(" "),n("p",[e._v("For instance using CURL you will send a request to the API like this (the body of the request being in the "),n("code",[e._v("data.json")]),e._v(" file):")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("SET "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("TOKEN")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"xxx"')]),e._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -X POST -H "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Authorization: Bearer %TOKEN%"')]),e._v(" ^\n     -H "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Content-Type: application/json"')]),e._v(" ^\n     -d @data.json ^\n     https://kano.dev.kalisio.xyz/api/service\n")])])]),n("p",[e._v("Detailed information about the concepts and the data model behind our feature services can be found in "),n("a",{attrs:{href:"https://kalisio.github.io/kdk/api/map/services.html#features-service",target:"_blank",rel:"noopener noreferrer"}},[e._v("the KDK documentation"),n("OutboundLink")],1),e._v(", although focused on how to retrieve the data.")]),e._v(" "),n("p",[e._v("To push a new station the body of the request will be a GeoJson feature like this:")]),e._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"properties"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"174412d9e-f230-4127-af36-75654e265f56"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Station 1"')]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"geometry"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Point"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"coordinates"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n      "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.5059948323127268")]),e._v("\n      "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("43.547168883180966")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Feature"')]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),n("p",[e._v("To push a new measure of the station the body of the request will be (a) GeoJson feature(s) like this:")]),e._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Single or multiple measures can be sent at once")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"time"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2023-04-28T16:00:00"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"properties"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"174412d9e-f230-4127-af36-75654e265f56"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"value"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("24")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"status"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"OK"')]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"geometry"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Point"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"coordinates"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n      "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.5059948323127268")]),e._v("\n      "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("43.547168883180966")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[e._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Feature"')]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("...")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),n("p",[e._v("First copy the new layers file in the "),n("code",[e._v("kano/api/config/layers")]),e._v(" directory. Then, add "),n("code",[e._v('"SENSORS"')]),e._v(" to your "),n("code",[e._v("LAYERS_FILTER")]),e._v(" environment variable and launch Kano again to make the new layers appear in your custom catalog.")]),e._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[e._v("sensors-layers.cjs - Used to define additional sensors layers based on API data feeding.")]),e._v(" "),n("div",{staticClass:"language-cjs extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("module.exports = [{\n  name: 'Layers.SENSORS',\n  description: 'Layers.SENSORS_DESCRIPTION',\n  i18n: {\n    fr: {\n      Layers: {\n        SENSORS: 'Capteurs',\n        SENSORS_DESCRIPTION: 'Réseau de capteurs'\n      },\n      Variables: {\n        TEMPERATURE: 'Température'\n      }\n    },\n    en: {\n      Layers: {\n        SENSORS: 'Sensors',\n        SENSORS_DESCRIPTION: 'Sensors network'\n      },\n      Variables: {\n        TEMPERATURE: 'Temperature'\n      }\n    }\n  },\n  tags: ['sensors'],\n  type: 'OverlayLayer',\n  service: 'sensors-observations',\n  probeService: 'sensors-stations',\n  ttl: 7 * 24 * 60 * 60,\n  featureId: 'id',\n  from: 'P-7D',\n  to: 'PT-1M',\n  every: 'PT10M',\n  queryFrom: 'PT-1H',\n  variables: [\n    {\n      name: 'temperature',\n      label: 'Variables.TEMPERATURE',\n      units: ['degC'],\n      range: [-50, 127],\n      step: 5,\n      chartjs: {\n        backgroundColor: 'rgba(255, 99, 132, 128)',\n        borderColor: 'rgb(255, 99, 132)',\n        fill: false\n      }\n    }\n  ],\n  leaflet: {\n    type: 'geoJson',\n    realtime: true,\n    tiled: true,\n    cluster: { disableClusteringAtZoom: 18 },\n    'marker-color': `<% if (properties.status === 'OK') { %>green<% }\n                        else { %>red<% } %>`,\n    'icon-classes': 'fa fa-wifi',\n    'icon-x-offset': -2,\n    'icon-color': '#FFF',\n    template: ['marker-color'],\n    tooltip: {\n      template: '<%= properties.name %>: <%= properties.temperature %>°C'\n    }\n  },\n  cesium: {\n    type: 'geoJson',\n    realtime: true,\n    cluster: { pixelRange: 50 },\n    'marker-symbol': 'lighthouse',\n    'marker-color': '#180EF1',\n    tooltip: {\n      template: '<%= properties.name %>: <%= properties.temperature %>°C'\n    }\n  }\n}]\n")])])])]),e._v(" "),n("p",[e._v("Now, feed the API using the provided data in the public folder of the documentation:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('curl -X POST -H "Authorization: Bearer %TOKEN%" -H "Content-Type: application/json" ^\n     -d @stations-data.json https://your.kano.domain/api/sensors-stations\ncurl -X POST -H "Authorization: Bearer %TOKEN%" -H "Content-Type: application/json" ^\n     -d @observations-data.json https://your.kano.domain/api/sensors-observations\n')])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),n("p",[e._v("For testing purpose you can get a valid token from the local storage in the developer tool after logged into Kano.")])]),e._v(" "),n("p",[e._v("Using the bottom timeline, navigate to a date/time with existing sensor data, you now should be able to see your sensor on the map, selecting it should open the value timeseries:")]),e._v(" "),n("p",[n("img",{attrs:{src:a(422),alt:"sensors layers"}})]),e._v(" "),n("p",[e._v("A data layer can contain multiple time-varying elements called "),n("em",[e._v("variables")]),e._v(". The features may contain additional properties, e.g. a status (OK/NOK), a name, etc. that can be used to customize the rendering, e.g. icon, color, tooltip, etc.")]),e._v(" "),n("p",[e._v("The main "),n("a",{attrs:{href:"https://kalisio.github.io/kdk/api/map/services.html#catalog-service",target:"_blank",rel:"noopener noreferrer"}},[e._v("configuration options"),n("OutboundLink")],1),e._v(" are the following:")]),e._v(" "),n("ul",[n("li",[e._v("the property that will be use to uniquely identify a station (i.e. ID)")]),e._v(" "),n("li",[e._v("the refresh rate of the data in the layer (used to automatically update the view every N seconds in Kano)")]),e._v(" "),n("li",[e._v("the "),n("em",[e._v("life time")]),e._v(" of a measure, i.e. if no measure found within the range "),n("code",[e._v("current time - life time")]),e._v(" the station is not considered to have performed any measure for current time")]),e._v(" "),n("li",[e._v("the list of the variables contained in the data with associated properties to ease timeseries display (unit, range, color, ...)")])]),e._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),n("p",[e._v("A layer can have no fixed stations but only measurements from sensors in order to display moving data")])]),e._v(" "),n("h2",{attrs:{id:"customizing-the-catalog-legend"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#customizing-the-catalog-legend"}},[e._v("#")]),e._v(" Customizing the catalog legend")]),e._v(" "),n("p",[n("strong",[e._v("To be completed")])])])}),[],!1,null,null,null);t.default=s.exports}}]);