(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{425:function(e,t,a){e.exports=a.p+"assets/img/kano-rte.4abe3aab.jpg"},426:function(e,t,a){e.exports=a.p+"assets/img/grafana-rte-overview.1e46dc5a.png"},427:function(e,t,a){e.exports=a.p+"assets/img/grafana-rte-details.6e8e4d1c.png"},428:function(e,t,a){e.exports=a.p+"assets/img/grafana-rte-architecture.38f90550.png"},454:function(e,t,a){"use strict";a.r(t);var r=a(5),o=Object(r.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"using-the-kano-api"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#using-the-kano-api"}},[e._v("#")]),e._v(" Using the Kano API")]),e._v(" "),r("h2",{attrs:{id:"description"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#description"}},[e._v("#")]),e._v(" Description")]),e._v(" "),r("p",[e._v("Kano exposes an API endpoint that can be used to query data stored in it's underlying "),r("a",{attrs:{href:"https://www.mongodb.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("MongoDB"),r("OutboundLink")],1),e._v(" database. The API will return "),r("a",{attrs:{href:"https://www.json.org",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSON"),r("OutboundLink")],1),e._v(" documents when queried. The endpoint is located on "),r("code",[e._v("$KANO_ROOT_URL/api/")])]),e._v(" "),r("h2",{attrs:{id:"what-s-available"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#what-s-available"}},[e._v("#")]),e._v(" What's available")]),e._v(" "),r("p",[e._v("This depends on which layers are declared in your Kano configuration. For each layer declaring a set of "),r("a",{attrs:{href:"https://kalisio.github.io/kdk/api/map/services.html#features-service",target:"_blank",rel:"noopener noreferrer"}},[e._v("features services"),r("OutboundLink")],1),e._v(", the api will expose the service's data through an URL formed by the API endpoint slash the service name.")]),e._v(" "),r("div",{staticClass:"custom-block tip"},[r("p",{staticClass:"custom-block-title"},[e._v("Example")]),e._v(" "),r("p",[e._v("If your Kano instance is exposed through "),r("code",[e._v("https://kano.foo.xyz")]),e._v(" then the api is available on "),r("code",[e._v("https://kano.foo.xyz/api")]),e._v(".\nIf for example you have the hubeau layer enabled (which instanciate both a "),r("code",[e._v("hubeau-stations")]),e._v(" and a "),r("code",[e._v("hubeau-observations")]),e._v(" features services), then the api will expose it's data on "),r("code",[e._v("https://kano.foo.xyz/api/hubeau-stations")]),e._v(" and "),r("code",[e._v("https://kano.foo.xyz/api/hubeau-observations")])])]),e._v(" "),r("h2",{attrs:{id:"authentification"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#authentification"}},[e._v("#")]),e._v(" Authentification")]),e._v(" "),r("p",[e._v("In order to access the API, clients must authenticate themselves. We use "),r("a",{attrs:{href:"https://jwt.io",target:"_blank",rel:"noopener noreferrer"}},[e._v("JWT"),r("OutboundLink")],1),e._v(" tokens to authenticate access to Kano. Those can be added as an HTTP query parameter, using "),r("code",[e._v("jwt=$your_token")]),e._v(" or can be passed through the "),r("code",[e._v("Authorization")]),e._v(" HTTP header, using the "),r("a",{attrs:{href:"https://datatracker.ietf.org/doc/html/rfc6750",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Bearer")]),e._v(" scheme"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("div",{staticClass:"custom-block warning"},[r("p",{staticClass:"custom-block-title"},[e._v("TODO")]),e._v(" "),r("p",[e._v("How to generate a JWT token ?")])]),e._v(" "),r("h2",{attrs:{id:"queries"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#queries"}},[e._v("#")]),e._v(" Queries")]),e._v(" "),r("p",[e._v("Queries to the Kano API are made to specific features services data which in turn query their specific underlying MongoDB collection. The way to query those collections is to use "),r("a",{attrs:{href:"https://feathersjs.com/api/databases/querying.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Feathers queries through REST URLs"),r("OutboundLink")],1),e._v(". In addition to those, we added in the "),r("a",{attrs:{href:"https://kalisio.github.io/kdk",target:"_blank",rel:"noopener noreferrer"}},[e._v("KDK"),r("OutboundLink")],1),e._v(" a few "),r("a",{attrs:{href:"https://kalisio.github.io/kdk/api/map/services.html#advanced-feature-filtering",target:"_blank",rel:"noopener noreferrer"}},[e._v("handy shortcuts"),r("OutboundLink")],1),e._v(" to express commonly used queries.")]),e._v(" "),r("h2",{attrs:{id:"use-case-example"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#use-case-example"}},[e._v("#")]),e._v(" Use case example")]),e._v(" "),r("p",[e._v("We used the Kano API to expose French nuclear power production data to a set of "),r("a",{attrs:{href:"https://grafana.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Grafana"),r("OutboundLink")],1),e._v(" dashboards.")]),e._v(" "),r("p",[e._v("We first developed a "),r("a",{attrs:{href:"https://kalisio.github.io/krawler/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Krawler"),r("OutboundLink")],1),e._v(" job whose task is to scrap power production data and to push it into Kano's backing MongoDB database. On Kano's side, we added a layer declaring a feature service pointing on the database collections the Krawler job was populating. From that time, nuclear power production data was available for display in Kano. Here's what it looks like :")]),e._v(" "),r("p",[r("img",{attrs:{src:a(425),alt:"Nucler power production data in Kano"}})]),e._v(" "),r("p",[e._v("Once the collections started being populated, we looked for ways to connect Grafana to Kano's API endpoint. For this we used the "),r("a",{attrs:{href:"https://sriramajeyam.com/grafana-infinity-datasource/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Infinity Grafana datasource plugin"),r("OutboundLink")],1),e._v(" allowing us to use it's JSON scrapping capabilities to feed Grafana. We created a JWT token for the datasource to be able to reach Kano's API. After creating dashboards and looking up some docs, we ended up with a set of synthetic dashboards:")]),e._v(" "),r("p",[r("img",{attrs:{src:a(426),alt:"Nuclear power production overview in Grafana"}}),e._v(" "),r("img",{attrs:{src:a(427),alt:"Nuclear power production detail in Grafana"}})]),e._v(" "),r("p",[e._v("Overall, here's the architecture of the whole solution :")]),e._v(" "),r("p",[r("img",{attrs:{src:a(428),alt:"Whole use case architecture"}})])])}),[],!1,null,null,null);t.default=o.exports}}]);